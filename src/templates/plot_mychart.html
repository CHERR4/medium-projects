<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<div class="chart-container" style="position: relative; height:40vh; width:80vw">
    <canvas id="myChart"></canvas>
</div>

<script>
    var chart = new Chart(document.getElementById("myChart"), {
        type: 'bar',
        data: {
        labels: [],
        datasets: [
            {
            label: "Hashtag",
            data: [],
            backgroundColor: ["#ffa822", "#134e6f", "#ff6150", "#1ac0c6", "#c8ce14", "#bb63d8", "#349baf", "#d9ea83", "#ffff00", "#dee0e6"], 
            }
        ]
        },
        options: {
            legend: { display: false },
            title: {
                display: true,
                text: 'Hashtag count'
            },
            scales: {
                xAxes: [{
                    ticks: {
                        fontSize: 20
                    }
                }],
                yAxes: [{
                    ticks: {
                        fontSize: 20
                    }
                }]

            }
        }
});
</script>
<script>
    setInterval(
        function updateValues() {

        var updatedData = $.get('/data');

        updatedData.done(makeChart);
        },100); 


    function makeChart(data) {
        console.log(data)
        var hashtag = data.map(function(d) {return d.hashtag;});
        var count = data.map(function(d) {return d.count;});
        console.log(hashtag)
        console.log(count)
        chart.data.labels = hashtag
        chart.data.datasets[0].data = count
        chart.update()
    }
</script>